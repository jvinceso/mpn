<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="recibo" pageWidth="595" pageHeight="421" orientation="Landscape" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="578900e3-0c5e-4102-8e31-dc6c573ab805">
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="mensaje" class="java.lang.String"/>
	<queryString>
		<![CDATA[SELECT rd.nRecId ,
			p.nPerId AS CodigoPersona ,
		   case MONTH(fv.dFevFecha_vence)
				WHEN 1 THEN "Enero"
				WHEN 2 THEN "Febrero"
				WHEN 3 THEN "Marzo"
				WHEN 4 THEN "Abril"
				WHEN 5 THEN "Mayo"
				WHEN 6 THEN "Junio"
				WHEN 7 THEN "Julio"
				WHEN 8 THEN "Agosto"
				WHEN 9 THEN "Septiembre"
				WHEN 10 THEN "Octubre"
				WHEN 11 THEN "Noviembre"
				WHEN 12 THEN "Diciembre"
				ELSE "Esto no es un Mes"
		   END as Mes,
	   		YEAR( fv.dFevFecha_vence ) as Anio,
       		CONCAT(p.cPerApellidoPaterno," ",p.cPerApellidoMaterno," ",p.cPerNombres) AS Nombres ,
       		CONCAT(v.cViaNombre," ",c.cCalNombre," ",pd.cPdeValor) AS Domicilio ,
       		s.cSecNombre AS Lugar ,
       		CONCAT(m.cMulDescripcion," - ",mt.cMulDescripcion) AS Concepto ,
       		rd.cRedPrecio AS Importe ,
       		DATE_FORMAT(cast(r.dRecFechaImpresion AS datetime),"%d/%m/%Y") AS FechaEmision ,
       		fv.dFevFecha_vence AS FechaVencimiento ,
       		CONCAT("S/. ",r.fRecDeuda) AS Deuda
		FROM recibo_detalle rd
			INNER JOIN recibo r ON rd.nRecId = r.nRecId
			INNER JOIN servicios_contribuyente sc ON sc.nSecId = rd.nSecId
			INNER JOIN servicios_tipo st ON st.nSetId = sc.nSetId
			INNER JOIN multitabla m ON m.nMulId = st.nMulServicio
			INNER JOIN multitabla mt ON mt.nMulId = st.nMulTipoServicio
			INNER JOIN fechas_vencimiento fv ON fv.nFevId = r.nFevId
			INNER JOIN persona p ON p.nPerId = r.nPerIdContribuyente
			INNER JOIN direccion_calle dc ON dc.nDicId = sc.nDicId
			INNER JOIN persona_detalle pd ON pd.nPdeId = dc.nPdeId
			INNER JOIN calle c ON c.nCalId = dc.nCalId
			INNER JOIN via v ON v.nViaId = c.nViaId
			INNER JOIN sector s ON s.nSecId = c.nSecId
		WHERE rd.nRecId IN(157,158,159,160,161,162,163)]]>
	</queryString>
	<field name="nRecId" class="java.lang.Integer">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="CodigoPersona" class="java.lang.Integer"/>
	<field name="Mes" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="Anio" class="java.lang.Long">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="Nombres" class="java.lang.String"/>
	<field name="Domicilio" class="java.lang.String"/>
	<field name="Lugar" class="java.lang.String"/>
	<field name="Concepto" class="java.lang.String"/>
	<field name="Importe" class="java.math.BigDecimal"/>
	<field name="FechaEmision" class="java.lang.String"/>
	<field name="FechaVencimiento" class="java.sql.Date"/>
	<field name="Deuda" class="java.lang.String"/>
	<variable name="total" class="java.lang.Integer" calculation="Sum"/>
	<group name="FacturaGrupo">
		<groupExpression><![CDATA[$F{nRecId}]]></groupExpression>
		<groupHeader>
			<band height="121">
				<staticText>
					<reportElement x="449" y="101" width="100" height="20" uuid="8aba5c1f-20e5-4df2-8059-3541937b95fd"/>
					<text><![CDATA[Importe]]></text>
				</staticText>
				<staticText>
					<reportElement x="149" y="101" width="100" height="20" uuid="3ddcd678-cf93-476d-a282-a49d3e36bdd0"/>
					<text><![CDATA[Concepto]]></text>
				</staticText>
				<textField pattern="MMMMM" isBlankWhenNull="true">
					<reportElement x="118" y="0" width="100" height="20" uuid="01072e8a-4095-48a2-8949-42472957cd73"/>
					<textFieldExpression><![CDATA[$F{Mes}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="18" y="20" width="100" height="20" uuid="d7c4bf4a-cbe3-4d74-a68b-0232958a0559"/>
					<textFieldExpression><![CDATA[$F{CodigoPersona}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="18" y="40" width="425" height="20" uuid="193c6d21-f75e-463b-9ee0-a688a5824e47"/>
					<textFieldExpression><![CDATA[$F{Nombres}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="18" y="61" width="531" height="20" uuid="db359651-a9fc-4f31-9d4e-303c58047200"/>
					<textFieldExpression><![CDATA[$F{Domicilio}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="18" y="81" width="100" height="20" uuid="44af8db4-f209-4918-ac89-23d151cf5cbd"/>
					<textFieldExpression><![CDATA[$F{Lugar}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="449" y="0" width="100" height="20" uuid="e8eb109e-fc37-40f7-8eb4-0c5d18c79709"/>
					<textFieldExpression><![CDATA[$F{nRecId}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="328" y="0" width="100" height="20" uuid="35ef584a-05a5-437a-a585-581d44a80307"/>
					<textFieldExpression><![CDATA[$F{Anio}]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
	</group>
	<title>
		<band splitType="Stretch"/>
	</title>
	<columnHeader>
		<band splitType="Stretch"/>
	</columnHeader>
	<detail>
		<band height="22" splitType="Stretch">
			<textField>
				<reportElement x="149" y="2" width="100" height="20" isPrintWhenDetailOverflows="true" uuid="fae4a212-c5d2-48e8-850f-46c53a8e6926"/>
				<textFieldExpression><![CDATA[$F{Concepto}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="455" y="2" width="100" height="20" uuid="716afd54-0e23-4d59-96d7-64ff0aed7e0a"/>
				<textFieldExpression><![CDATA[$F{Importe}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band height="117" splitType="Stretch">
			<textField>
				<reportElement x="449" y="0" width="106" height="20" uuid="22a7b001-efdd-4407-8cb4-fca4d0f1652c"/>
				<textFieldExpression><![CDATA[$F{Deuda}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="449" y="57" width="106" height="20" uuid="f17b249c-9efe-401c-8776-bffc6fba5229"/>
				<textFieldExpression><![CDATA[$F{FechaEmision}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="449" y="77" width="106" height="20" uuid="f3877bf5-5cf0-420f-accf-221c2b81fba0"/>
				<textFieldExpression><![CDATA[$F{FechaVencimiento}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement positionType="FixRelativeToBottom" stretchType="RelativeToBandHeight" x="24" y="20" width="516" height="37" uuid="ceef0e7c-b89a-41ac-9ec6-4a40e7a5f58a"/>
				<textElement textAlignment="Justified"/>
				<textFieldExpression><![CDATA[$P{mensaje}]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
	<summary>
		<band splitType="Stretch"/>
	</summary>
</jasperReport>
